# Тест-кейсы для API тестирования

## Базовый URL
`https://apitests.nyc.wf`

---

## 1. Авторизация (POST /authorization)

### TC-AUTH-001: Успешная авторизация с валидными данными
**Приоритет:** P0 (Critical)  
**Тип:** Позитивный

**Предусловия:** Нет

**Шаги:**
1. Отправить POST запрос на `/authorization`
2. Установить заголовки:
   - `Content-Type: application/x-www-form-urlencoded`
   - `Accept: application/json`
3. Передать параметры:
   - `username=admin`
   - `password=qazWSXedc`

**Ожидаемый результат:**
- HTTP статус: 200
- Ответ содержит:
  ```json
  {
    "result": "OK",
    "token": "<непустая строка>",
    "balance": 10000
  }
  ```
- Токен не пустой
- Balance = 10000

---

### TC-AUTH-002: Авторизация с неверным паролем
**Приоритет:** P1 (High)  
**Тип:** Негативный

**Предусловия:** Нет

**Шаги:**
1. Отправить POST запрос на `/authorization`
2. Установить заголовки:
   - `Content-Type: application/x-www-form-urlencoded`
   - `Accept: application/json`
3. Передать параметры:
   - `username=admin`
   - `password=wrongpassword`

**Ожидаемый результат:**
- HTTP статус: 401 или 400
- Ответ содержит:
  ```json
  {
    "result": "ERROR",
    "message": "<описание ошибки>"
  }
  ```

---

### TC-AUTH-003: Авторизация с неверным логином
**Приоритет:** P1 (High)  
**Тип:** Негативный

**Предусловия:** Нет

**Шаги:**
1. Отправить POST запрос на `/authorization`
2. Установить заголовки:
   - `Content-Type: application/x-www-form-urlencoded`
   - `Accept: application/json`
3. Передать параметры:
   - `username=wronguser`
   - `password=qazWSXedc`

**Ожидаемый результат:**
- HTTP статус: 401 или 400
- Ответ содержит:
  ```json
  {
    "result": "ERROR",
    "message": "<описание ошибки>"
  }
  ```

---

### TC-AUTH-004: Авторизация без параметра username
**Приоритет:** P1 (High)  
**Тип:** Негативный

**Предусловия:** Нет

**Шаги:**
1. Отправить POST запрос на `/authorization`
2. Установить заголовки:
   - `Content-Type: application/x-www-form-urlencoded`
   - `Accept: application/json`
3. Передать только параметр:
   - `password=qazWSXedc`

**Ожидаемый результат:**
- HTTP статус: 400
- Ответ содержит:
  ```json
  {
    "result": "ERROR",
    "message": "<описание ошибки>"
  }
  ```

---

### TC-AUTH-005: Авторизация без параметра password
**Приоритет:** P1 (High)  
**Тип:** Негативный

**Предусловия:** Нет

**Шаги:**
1. Отправить POST запрос на `/authorization`
2. Установить заголовки:
   - `Content-Type: application/x-www-form-urlencoded`
   - `Accept: application/json`
3. Передать только параметр:
   - `username=admin`

**Ожидаемый результат:**
- HTTP статус: 400
- Ответ содержит:
  ```json
  {
    "result": "ERROR",
    "message": "<описание ошибки>"
  }
  ```

---

### TC-AUTH-006: Авторизация с пустым username
**Приоритет:** P2 (Medium)  
**Тип:** Негативный

**Предусловия:** Нет

**Шаги:**
1. Отправить POST запрос на `/authorization`
2. Установить заголовки:
   - `Content-Type: application/x-www-form-urlencoded`
   - `Accept: application/json`
3. Передать параметры:
   - `username=`
   - `password=qazWSXedc`

**Ожидаемый результат:**
- HTTP статус: 400
- Ответ содержит:
  ```json
  {
    "result": "ERROR",
    "message": "<описание ошибки>"
  }
  ```

---

### TC-AUTH-007: Авторизация с пустым password
**Приоритет:** P2 (Medium)  
**Тип:** Негативный

**Предусловия:** Нет

**Шаги:**
1. Отправить POST запрос на `/authorization`
2. Установить заголовки:
   - `Content-Type: application/x-www-form-urlencoded`
   - `Accept: application/json`
3. Передать параметры:
   - `username=admin`
   - `password=`

**Ожидаемый результат:**
- HTTP статус: 400
- Ответ содержит:
  ```json
  {
    "result": "ERROR",
    "message": "<описание ошибки>"
  }
  ```

---

### TC-AUTH-008: Авторизация с неверным Content-Type
**Приоритет:** P2 (Medium)  
**Тип:** Негативный

**Предусловия:** Нет

**Шаги:**
1. Отправить POST запрос на `/authorization`
2. Установить заголовки:
   - `Content-Type: application/json`
   - `Accept: application/json`
3. Передать параметры в JSON формате

**Ожидаемый результат:**
- HTTP статус: 400 или 415
- Ответ содержит ошибку

---

## 2. Транзакции (POST /transaction)

### TC-TRANS-001: Успешное выполнение транзакции withdraw
**Приоритет:** P0 (Critical)  
**Тип:** Позитивный

**Предусловия:** 
- Получен валидный токен через `/authorization`

**Шаги:**
1. Авторизоваться и получить токен
2. Отправить POST запрос на `/transaction`
3. Установить заголовки:
   - `Content-Type: application/x-www-form-urlencoded`
   - `Accept: application/json`
   - `X-Api-Key: <полученный токен>`
4. Передать параметры:
   - `action=WITHDRAW` (⚠️ **Примечание:** API требует верхний регистр, хотя в спецификации указан нижний)
   - `amount=10.00`

**Ожидаемый результат:**
- HTTP статус: 200
- Ответ содержит:
  ```json
  {
    "result": "OK",
    "balance": 9990.00
  }
  ```
- Balance уменьшился на сумму транзакции

---

### TC-TRANS-002: Транзакция без токена авторизации
**Приоритет:** P0 (Critical)  
**Тип:** Негативный

**Предусловия:** Нет

**Шаги:**
1. Отправить POST запрос на `/transaction`
2. Установить заголовки:
   - `Content-Type: application/x-www-form-urlencoded`
   - `Accept: application/json`
   - Без заголовка `X-Api-Key`
3. Передать параметры:
   - `action=withdraw`
   - `amount=10.00`

**Ожидаемый результат:**
- HTTP статус: 401
- Ответ содержит:
  ```json
  {
    "result": "ERROR",
    "message": "invalid token" или подобное
  }
  ```

---

### TC-TRANS-003: Транзакция с невалидным токеном
**Приоритет:** P1 (High)  
**Тип:** Негативный

**Предусловия:** Нет

**Шаги:**
1. Отправить POST запрос на `/transaction`
2. Установить заголовки:
   - `Content-Type: application/x-www-form-urlencoded`
   - `Accept: application/json`
   - `X-Api-Key: invalid_token_12345`
3. Передать параметры:
   - `action=withdraw`
   - `amount=10.00`

**Ожидаемый результат:**
- HTTP статус: 401
- Ответ содержит:
  ```json
  {
    "result": "ERROR",
    "message": "invalid token" или подобное
  }
  ```

---

### TC-TRANS-004: Транзакция с истекшим токеном
**Приоритет:** P1 (High)  
**Тип:** Негативный

**Предусловия:** 
- Получен токен через `/authorization`
- Прошло более 15 минут без использования токена

**Шаги:**
1. Авторизоваться и получить токен
2. Подождать более 15 минут
3. Отправить POST запрос на `/transaction` с этим токеном
4. Установить заголовки:
   - `Content-Type: application/x-www-form-urlencoded`
   - `Accept: application/json`
   - `X-Api-Key: <истекший токен>`
5. Передать параметры:
   - `action=withdraw`
   - `amount=10.00`

**Ожидаемый результат:**
- HTTP статус: 401
- Ответ содержит:
  ```json
  {
    "result": "ERROR",
    "message": "invalid token" или "token expired" или подобное
  }
  ```

---

### TC-TRANS-005: Транзакция без параметра action
**Приоритет:** P1 (High)  
**Тип:** Негативный

**Предусловия:** 
- Получен валидный токен через `/authorization`

**Шаги:**
1. Авторизоваться и получить токен
2. Отправить POST запрос на `/transaction`
3. Установить заголовки:
   - `Content-Type: application/x-www-form-urlencoded`
   - `Accept: application/json`
   - `X-Api-Key: <токен>`
4. Передать только параметр:
   - `amount=10.00`

**Ожидаемый результат:**
- HTTP статус: 400
- Ответ содержит:
  ```json
  {
    "result": "ERROR",
    "message": "<описание ошибки>"
  }
  ```

---

### TC-TRANS-006: Транзакция без параметра amount
**Приоритет:** P1 (High)  
**Тип:** Негативный

**Предусловия:** 
- Получен валидный токен через `/authorization`

**Шаги:**
1. Авторизоваться и получить токен
2. Отправить POST запрос на `/transaction`
3. Установить заголовки:
   - `Content-Type: application/x-www-form-urlencoded`
   - `Accept: application/json`
   - `X-Api-Key: <токен>`
4. Передать только параметр:
   - `action=withdraw`

**Ожидаемый результат:**
- HTTP статус: 400
- Ответ содержит:
  ```json
  {
    "result": "ERROR",
    "message": "<описание ошибки>"
  }
  ```

---

### TC-TRANS-007: Транзакция с невалидным action
**Приоритет:** P1 (High)  
**Тип:** Негативный

**Предусловия:** 
- Получен валидный токен через `/authorization`

**Шаги:**
1. Авторизоваться и получить токен
2. Отправить POST запрос на `/transaction`
3. Установить заголовки:
   - `Content-Type: application/x-www-form-urlencoded`
   - `Accept: application/json`
   - `X-Api-Key: <токен>`
4. Передать параметры:
   - `action=deposit`
   - `amount=10.00`

**Ожидаемый результат:**
- HTTP статус: 400
- Ответ содержит:
  ```json
  {
    "result": "ERROR",
    "message": "<описание ошибки>"
  }
  ```

---

### TC-TRANS-008: Транзакция с отрицательной суммой
**Приоритет:** P1 (High)  
**Тип:** Негативный

**Предусловия:** 
- Получен валидный токен через `/authorization`

**Шаги:**
1. Авторизоваться и получить токен
2. Отправить POST запрос на `/transaction`
3. Установить заголовки:
   - `Content-Type: application/x-www-form-urlencoded`
   - `Accept: application/json`
   - `X-Api-Key: <токен>`
4. Передать параметры:
   - `action=withdraw`
   - `amount=-10.00`

**Ожидаемый результат:**
- HTTP статус: 400
- Ответ содержит:
  ```json
  {
    "result": "ERROR",
    "message": "<описание ошибки>"
  }
  ```

---

### TC-TRANS-009: Транзакция с нулевой суммой
**Приоритет:** P2 (Medium)  
**Тип:** Негативный

**Предусловия:** 
- Получен валидный токен через `/authorization`

**Шаги:**
1. Авторизоваться и получить токен
2. Отправить POST запрос на `/transaction`
3. Установить заголовки:
   - `Content-Type: application/x-www-form-urlencoded`
   - `Accept: application/json`
   - `X-Api-Key: <токен>`
4. Передать параметры:
   - `action=withdraw`
   - `amount=0`

**Ожидаемый результат:**
- HTTP статус: 400
- Ответ содержит:
  ```json
  {
    "result": "ERROR",
    "message": "<описание ошибки>"
  }
  ```

---

### TC-TRANS-010: Транзакция с суммой больше баланса
**Приоритет:** P1 (High)  
**Тип:** Негативный

**Предусловия:** 
- Получен валидный токен через `/authorization`
- Баланс = 10000

**Шаги:**
1. Авторизоваться и получить токен
2. Отправить POST запрос на `/transaction`
3. Установить заголовки:
   - `Content-Type: application/x-www-form-urlencoded`
   - `Accept: application/json`
   - `X-Api-Key: <токен>`
4. Передать параметры:
   - `action=withdraw`
   - `amount=20000.00`

**Ожидаемый результат:**
- HTTP статус: 400
- Ответ содержит:
  ```json
  {
    "result": "ERROR",
    "message": "insufficient funds" или подобное
  }
  ```

---

### TC-TRANS-011: Транзакция с невалидным форматом amount (текст)
**Приоритет:** P2 (Medium)  
**Тип:** Негативный

**Предусловия:** 
- Получен валидный токен через `/authorization`

**Шаги:**
1. Авторизоваться и получить токен
2. Отправить POST запрос на `/transaction`
3. Установить заголовки:
   - `Content-Type: application/x-www-form-urlencoded`
   - `Accept: application/json`
   - `X-Api-Key: <токен>`
4. Передать параметры:
   - `action=withdraw`
   - `amount=abc`

**Ожидаемый результат:**
- HTTP статус: 400
- Ответ содержит:
  ```json
  {
    "result": "ERROR",
    "message": "<описание ошибки>"
  }
  ```

---

### TC-TRANS-012: Транзакция с очень большой суммой
**Приоритет:** P2 (Medium)  
**Тип:** Негативный

**Предусловия:** 
- Получен валидный токен через `/authorization`

**Шаги:**
1. Авторизоваться и получить токен
2. Отправить POST запрос на `/transaction`
3. Установить заголовки:
   - `Content-Type: application/x-www-form-urlencoded`
   - `Accept: application/json`
   - `X-Api-Key: <токен>`
4. Передать параметры:
   - `action=withdraw`
   - `amount=999999999999999.99`

**Ожидаемый результат:**
- HTTP статус: 400
- Ответ содержит ошибку

---

### TC-TRANS-013: Проверка обновления баланса после транзакции
**Приоритет:** P0 (Critical)  
**Тип:** Позитивный

**Предусловия:** 
- Получен валидный токен через `/authorization`

**Шаги:**
1. Авторизоваться и получить токен, запомнить начальный баланс (10000)
2. Выполнить транзакцию на сумму 50.00
3. Выполнить еще одну транзакцию на сумму 25.50
4. Проверить баланс в ответе

**Ожидаемый результат:**
- После первой транзакции: balance = 9950.00
- После второй транзакции: balance = 9924.50
- Баланс корректно уменьшается

---

## 3. Завершение сессии (GET /logout)

### TC-LOGOUT-001: Успешное завершение сессии
**Приоритет:** P0 (Critical)  
**Тип:** Позитивный

**Предусловия:** 
- Получен валидный токен через `/authorization`

**Шаги:**
1. Авторизоваться и получить токен
2. Отправить POST запрос на `/logout` (⚠️ **Примечание:** API требует POST, хотя в спецификации указан GET)
3. Установить заголовки:
   - `Accept: application/json`
   - `X-Api-Key: <токен>`

**Ожидаемый результат:**
- HTTP статус: 200
- Ответ содержит:
  ```json
  {
    "result": "OK"
  }
  ```

---

### TC-LOGOUT-002: Завершение сессии без токена
**Приоритет:** P1 (High)  
**Тип:** Негативный

**Предусловия:** Нет

**Шаги:**
1. Отправить POST запрос на `/logout` (⚠️ **Примечание:** API требует POST)
2. Установить заголовки:
   - `Accept: application/json`
   - Без заголовка `X-Api-Key`

**Ожидаемый результат:**
- HTTP статус: 401
- Ответ содержит:
  ```json
  {
    "result": "ERROR",
    "message": "invalid token" или подобное
  }
  ```
---

### TC-LOGOUT-003: Завершение сессии с невалидным токеном
**Приоритет:** P1 (High)  
**Тип:** Негативный

**Предусловия:** Нет

**Шаги:**
1. Отправить POST запрос на `/logout` (⚠️ **Примечание:** API требует POST)
2. Установить заголовки:
   - `Accept: application/json`
   - `X-Api-Key: invalid_token_12345`

**Ожидаемый результат:**
- HTTP статус: 401
- Ответ содержит:
  ```json
  {
    "result": "ERROR",
    "message": "invalid token" или подобное
  }
  ```

---

### TC-LOGOUT-004: Использование токена после logout
**Приоритет:** P1 (High)  
**Тип:** Негативный

**Предусловия:** 
- Получен валидный токен через `/authorization`

**Шаги:**
1. Авторизоваться и получить токен
2. Выполнить `/logout` с этим токеном
3. Попытаться выполнить транзакцию с этим же токеном

**Ожидаемый результат:**
- Транзакция должна вернуть ошибку:
  ```json
  {
    "result": "ERROR",
    "message": "invalid token" или подобное
  }
  ```

---

## 4. Интеграционные тесты

### TC-INT-001: Полный цикл: авторизация → транзакция → logout
**Приоритет:** P0 (Critical)  
**Тип:** Позитивный

**Предусловия:** Нет

**Шаги:**
1. Авторизоваться и получить токен
2. Выполнить транзакцию withdraw на сумму 100.00
3. Выполнить logout
4. Попытаться выполнить еще одну транзакцию с тем же токеном

**Ожидаемый результат:**
- Все шаги 1-3 выполняются успешно
- Шаг 4 возвращает ошибку invalid token

---

### TC-INT-002: Множественные транзакции в одной сессии
**Приоритет:** P1 (High)  
**Тип:** Позитивный

**Предусловия:** Нет

**Шаги:**
1. Авторизоваться и получить токен
2. Выполнить 5 транзакций подряд с разными суммами
3. Проверить, что баланс корректно уменьшается

**Ожидаемый результат:**
- Все транзакции выполняются успешно
- Баланс корректно уменьшается после каждой транзакции

---

## Статистика тест-кейсов

- **Всего тест-кейсов:** 30
- **Позитивных:** 5
- **Негативных:** 25
- **P0 (Critical):** 5
- **P1 (High):** 19
- **P2 (Medium):** 6

