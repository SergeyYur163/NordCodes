# Баг-репорты

## BUG-001: Несоответствие регистра значения параметра action в транзакциях

**Приоритет:** High  
**Серьезность:** Medium  
**Статус:** Открыт

### Описание
API требует значение параметра `action` в верхнем регистре (`WITHDRAW`), хотя в спецификации указано значение в нижнем регистре (`withdraw`).

### Шаги для воспроизведения
1. Авторизоваться через `/authorization` с валидными данными (username=admin, password=qazWSXedc)
2. Получить токен из ответа
3. Отправить POST запрос на `/transaction` с заголовком `X-Api-Key: <токен>`
4. Передать параметры:
   - `action=withdraw` (в нижнем регистре, как указано в спецификации)
   - `amount=10.00`

### Фактический результат
- HTTP статус: 400
- Ответ:
  ```json
  {
    "result": "ERROR",
    "message": "action: invalid action 'withdraw'. Allowed: [WITHDRAW]"
  }
  ```

### Ожидаемый результат
- HTTP статус: 200
- Ответ:
  ```json
  {
    "result": "OK",
    "balance": 9990.00
  }
  ```

### Окружение
- API URL: https://apitests.nyc.wf
- Метод: POST /transaction
- Дата обнаружения: [текущая дата]

### Дополнительная информация
Согласно спецификации, пример запроса содержит `action=withdraw` (в нижнем регистре), но API фактически требует `WITHDRAW` (в верхнем регистре). Это несоответствие между документацией и реализацией.

### Рекомендации
1. Обновить спецификацию, указав, что значение должно быть в верхнем регистре: `WITHDRAW`
2. ИЛИ обновить API, чтобы он принимал значение в нижнем регистре: `withdraw`
3. ИЛИ сделать API нечувствительным к регистру (case-insensitive)

---

## BUG-002: Эндпоинт /logout не поддерживает метод GET

**Приоритет:** High  
**Серьезность:** High  
**Статус:** Открыт

### Описание
Эндпоинт `/logout` не поддерживает метод GET, хотя в спецификации явно указан метод GET. API возвращает ошибку 405 (Method Not Allowed) и сообщает, что поддерживается только метод POST.

### Шаги для воспроизведения
1. Авторизоваться через `/authorization` с валидными данными (username=admin, password=qazWSXedc)
2. Получить токен из ответа
3. Отправить GET запрос на `/logout` с заголовком `X-Api-Key: <токен>`

### Фактический результат
- HTTP статус: 405 (Method Not Allowed)
- Ответ:
  ```json
  {
    "result": "ERROR",
    "message": "Request method 'GET' is not supported. Supported methods are: [POST]"
  }
  ```

### Ожидаемый результат
- HTTP статус: 200
- Ответ:
  ```json
  {
    "result": "OK"
  }
  ```

### Окружение
- API URL: https://apitests.nyc.wf
- Метод: GET /logout (согласно спецификации)
- Дата обнаружения: [текущая дата]

### Дополнительная информация
Согласно спецификации, пример запроса для `/logout` использует метод GET:
```
GET /logout HTTP/1.1
Host: apitests.nyc.wf
Accept: application/json
X-Api-Key: 1C2291E28A984BCB98FBAB075088FDE5
```

Но API фактически требует метод POST.

### Рекомендации
1. Обновить спецификацию, указав, что `/logout` использует метод POST
2. ИЛИ обновить API, чтобы он поддерживал метод GET для `/logout`

---

## BUG-003: Несоответствие HTTP статус кодов в ответах на ошибки

**Приоритет:** Medium  
**Серьезность:** Low  
**Статус:** Открыт

### Описание
При авторизации с неверными учетными данными API возвращает статус 403 (Forbidden), хотя более корректным было бы использовать 401 (Unauthorized).

### Шаги для воспроизведения
1. Отправить POST запрос на `/authorization`
2. Передать неверные учетные данные:
   - `username=admin`
   - `password=wrongpassword`

### Фактический результат
- HTTP статус: 403 (Forbidden)
- Ответ:
  ```json
  {
    "result": "ERROR",
    "message": "Invalid credentials"
  }
  ```

### Ожидаемый результат
- HTTP статус: 401 (Unauthorized)
- Ответ:
  ```json
  {
    "result": "ERROR",
    "message": "Invalid credentials"
  }
  ```

### Окружение
- API URL: https://apitests.nyc.wf
- Метод: POST /authorization
- Дата обнаружения: [текущая дата]

### Дополнительная информация
Согласно стандартам HTTP:
- 401 (Unauthorized) - используется когда требуется аутентификация или она не прошла
- 403 (Forbidden) - используется когда аутентификация прошла, но у пользователя нет прав доступа

В данном случае, когда неверные учетные данные, более корректно использовать 401.

### Рекомендации
Изменить HTTP статус код с 403 на 401 для случаев неверных учетных данных при авторизации.

---

## Статистика багов

- **Всего найдено:** 3
- **High приоритет:** 2
- **Medium приоритет:** 1
- **High серьезность:** 1
- **Medium серьезность:** 1
- **Low серьезность:** 1

